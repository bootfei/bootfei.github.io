---
title: 服务端性能优化-01-单台4核8G机器支撑5万QPS
date: 2021-05-12 00:19:51
tags:
---



## Tcpdump

### 1. tcpDump介绍

### 2. tcpDump工作原理

### 3. tcpDump如何使用

#### 前置操作：开启网卡的混合模式

|      | 网卡的默认                                                   | 网卡的混合模式                                               |
| ---- | ------------------------------------------------------------ | ------------------------------------------------------------ |
|      | 默认情况下，tcpdump不会抓取本机内部通讯的报文。根据网络协议栈的规定，对于报文，即使是目的地是本机，也需要经过本机的网络协议层，所以本机通讯肯定是通过API进入了内核，并且完成了路由选择。【比如本机的TCP通信，也必须要socket通信的基本要素：src ip port dst ip port】 | 如果要使用tcpdump抓取其他主机MAC地址的数据包，必须开启网卡混杂模式。<br />所谓混杂模式，用最简单的语言就是让网卡抓取任何经过它的数据包，不管这个数据包是不是发给它或者是它发出的。一般而言，Unix不会让普通用户设置混杂模式，因为这样可以看到别人的信息，比如telnet的用户名和密码，这样会引起一些安全上的问题，所以只有root用户可以开启混杂模式， |
| 命令 |                                                              | ifconfig en0 promisc<br /> en0是你要打开混杂模式的网卡。     |
|      |                                                              |                                                              |







### 
